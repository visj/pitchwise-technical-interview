{
  "version": 3,
  "sources": ["../src/server.ts", "../src/types.ts", "../src/mock.ts", "../src/Engine.ts"],
  "sourcesContent": ["import { createServer, IncomingMessage, ServerResponse } from \"http\";\nimport { WebSocketServer } from \"ws\";\nimport { readFile } from \"fs\";\nimport { join } from \"path\";\nimport { InsightEngine } from \"./Engine\";\nimport { Operation, Reset } from \"./types\";\n\nconst __dirname = import.meta.dirname;\n\nconst PORT = 8080;\n\n// Serve a file helper\nfunction serveFile(filePath: string, contentType: string, res: ServerResponse<IncomingMessage>) {\n    readFile(filePath, (err, data) => {\n        if (err) {\n            res.writeHead(500, { \"Content-Type\": \"text/plain\" });\n            res.end(\"Internal Server Error\");\n            console.error(err);\n            return;\n        }\n        res.writeHead(200, { \"Content-Type\": contentType });\n        res.end(data);\n    });\n}\n\nconst httpServer = createServer((req, res) => {\n    let filePath: string;\n    let contentType: string;\n    switch (req.url) {\n        case \"/\":\n        case \"/index.html\":\n            filePath = join(__dirname, \"index.html\");\n            contentType = \"text/html\";\n            break;\n        case \"/index.css\":\n            filePath = join(__dirname, \"index.css\");\n            contentType = \"text/css\";\n            break;\n        case \"/index.js\":\n            filePath = join(__dirname, \"index.js\");\n            contentType = \"application/javascript\";\n            break;\n        case \"/index.js.map\":\n            filePath = join(__dirname, \"index.js.map\");\n            contentType = \"application/json\";\n            break;\n        default:\n            res.writeHead(404, { \"Content-Type\": \"text/plain\" });\n            res.end(\"404 Not Found\");\n            return;\n    }\n    serveFile(filePath, contentType, res);\n});\n\nconst wss = new WebSocketServer({ server: httpServer });\n\nconst engine = new InsightEngine();\n\nwss.on(\"connection\", (ws) => {\n\n    const reset: Reset = {\n        type: Operation.Reset,\n        payload: engine.insights()\n    }; \n    ws.send(JSON.stringify(reset));\n\n    const interval = setInterval(() => {\n        const changeset = engine.mutate();\n        if (changeset.type !== Operation.NoOp) {\n            ws.send(JSON.stringify(changeset));\n        }\n    }, 1000);\n\n    ws.on(\"close\", () => {\n        clearInterval(interval);\n    });\n});\n\nhttpServer.listen(PORT, () => {\n    console.log(`Server is running at http://localhost:${PORT}`);\n});", "export type InsightRow = {\n    id: number;\n    name: string;\n    action: string;\n}\n\nexport type Insight = {\n    title: string;\n    rows: InsightRow[];\n}\n\nexport const enum Operation {\n    NoOp = 0,\n    Reset = 1,\n    AddRows = 2,\n    DelRows = 3,\n    SortRows = 4,\n    AddInsights = 5,\n    DelInsights = 6,\n    SortInsights = 7\n}\n\nexport const Operations: Operation[] = [\n    Operation.NoOp,\n    Operation.Reset,\n    Operation.AddRows,\n    Operation.DelRows,\n    Operation.SortRows,\n    Operation.AddInsights,\n    Operation.DelInsights,\n    Operation.SortInsights\n];\n\nexport type NoOp = {\n    readonly type: Operation.NoOp;\n}\n\nexport type Reset = {\n    readonly type: Operation.Reset;\n    readonly payload: readonly Insight[];\n};\n\nexport type AddRows = {\n    readonly type: Operation.AddRows;\n    readonly payload: {\n        readonly index: number,\n        readonly value: readonly InsightRow[]\n    }\n};\n\nexport type DelRows = {\n    readonly type: Operation.DelRows;\n    readonly payload: {\n        readonly index: number;\n        readonly count: number;\n    }\n};\n\n/**\n * TODO Implement these types\n */\nexport type SortRows = {\n    readonly type: Operation.SortRows;\n    readonly payload: unknown;\n};\n\nexport type AddInsights = {\n    readonly type: Operation.AddInsights;\n    readonly payload: unknown;\n}\n\nexport type DelInsights = {\n    readonly type: Operation.DelInsights;\n    readonly payload: unknown;\n}\n\nexport type SortInsights = {\n    readonly type: Operation.SortInsights;\n    readonly payload: unknown;\n}\n\nexport type Mutation = NoOp \n    | Reset \n    | AddRows \n    | DelRows \n    | SortRows\n    | AddInsights\n    | DelInsights\n    | SortInsights;", "export const actions = [\n    \"Saved Graph\",\n    \"Printed Presentation\",\n    \"Highlighted Image\",\n    \"Next Page Image\",\n    \"Saved Link\",\n    \"Downloaded Pitchdeck\",\n    \"Exited Slide\",\n    \"Next Page Table\",\n    \"Saved Content\",\n    \"Highlighted Table\",\n    \"Zoomed In Annotation\",\n    \"Zoomed Out Graph\",\n    \"Zoomed Out Link\",\n    \"Removed Bookmark Comment\",\n    \"Previous Page Image\",\n    \"Next Page Annotation\",\n    \"Removed Bookmark Table\",\n    \"Previous Page Table\",\n    \"Sent Feedback Image\",\n    \"Shared Pitchdeck\",\n    \"Highlighted Content\",\n    \"Zoomed Out Link\",\n    \"Copied Attachment\",\n    \"Closed Link\",\n    \"Viewed Snippet\",\n    \"Removed Bookmark Attachment\",\n    \"Exited Table\",\n    \"Opened Video\",\n    \"Closed Video\",\n    \"Previous Page Diagram\",\n    \"Highlighted Pitchdeck\",\n    \"Previous Page Slide\",\n    \"Pasted Link\",\n    \"Exited File\",\n    \"Bookmarked Diagram\",\n    \"Viewed Figure\",\n    \"Shared Annotation\",\n    \"Exited Diagram\",\n    \"Viewed File\",\n    \"Pasted Comment\",\n    \"Printed Diagram\",\n    \"Previous Page File\",\n    \"Printed Chart\",\n    \"Printed Snippet\",\n    \"Bookmarked Snippet\",\n    \"Downloaded Image\",\n    \"Exited Annotation\",\n    \"Zoomed Out Section\",\n    \"Sent Feedback File\",\n    \"Printed Comment\",\n    \"Highlighted Page\",\n    \"Zoomed Out Table\",\n    \"Highlighted Comment\",\n    \"Closed Chart\",\n    \"Sent Annotation\",\n    \"Saved Image\",\n    \"Sent Feedback Video\",\n    \"Copied File\",\n    \"Bookmarked Snippet\",\n    \"Closed Video\",\n    \"Shared File\",\n    \"Next Page Pitchdeck\",\n    \"Next Page Diagram\",\n    \"Next Page Video\",\n    \"Zoomed Out Section\",\n    \"Highlighted Content\",\n    \"Commented Attachment\",\n    \"Removed Bookmark Diagram\",\n    \"Viewed Section\",\n    \"Zoomed Out Annotation\",\n    \"Zoomed Out Chart\",\n    \"Opened Slide\",\n    \"Highlighted Figure\",\n    \"Zoomed In Comment\",\n    \"Next Page Attachment\",\n    \"Previous Page Annotation\",\n    \"Commented Page\",\n    \"Downloaded Section\",\n    \"Previous Page Annotation\",\n    \"Viewed Snippet\",\n    \"Sent Section\",\n    \"Commented Attachment\",\n    \"Opened File\",\n    \"Commented Attachment\",\n    \"Zoomed In Attachment\",\n    \"Copied Table\",\n    \"Sent Feedback Presentation\",\n    \"Shared Video\",\n    \"Copied Section\",\n    \"Sent Feedback Image\",\n    \"Opened Image\",\n    \"Zoomed In Slide\",\n    \"Next Page Figure\",\n    \"Sent Snippet\",\n    \"Sent Chart\",\n    \"Next Page Link\",\n    \"Bookmarked Annotation\",\n    \"Saved Presentation\",\n    \"Printed Snippet\",\n    \"Sent Chart\"\n];\n\nexport const visitors = [\n    \"Kwesi\", \"Zuberi\", \"Kwesi\", \"Amina\", \"Moyo\", \"Akua\", \"Moyo\", \"Oba\", \"Ngozi\", \"Efe\",\n    \"Amara\", \"Nkechi\", \"Oba\", \"Fatou\", \"Akua\", \"Tunde\", \"Chinwe\", \"Kelechi\", \"Femi\", \"Sekou\",\n    \"Chinwe\", \"Kwesi\", \"Omari\", \"Bayo\", \"Kofi\", \"Obinna\", \"Nia\", \"Ade\", \"Esi\", \"Yemi\",\n    \"Zainab\", \"Kwesi\", \"Imani\", \"Zuberi\", \"Penda\", \"Imani\", \"Moyo\", \"Zuberi\", \"Zola\", \"Gbenga\",\n    \"Imani\", \"Efe\", \"Gbenga\", \"Sade\", \"Zainab\", \"Zola\", \"Amina\", \"Fatou\", \"Ngozi\", \"Chike\",\n    \"Taye\", \"Nia\", \"Malik\", \"Kelechi\", \"Chinwe\", \"Gbenga\", \"Yemi\", \"Zainab\", \"Bayo\", \"Ayo\",\n    \"Nia\", \"Lamine\", \"Imani\", \"Kofi\", \"Ngozi\", \"Obinna\", \"Nia\", \"Gbenga\", \"Gbenga\", \"Zola\",\n    \"Efe\", \"Lamine\", \"Juma\", \"Efe\", \"Amara\", \"Moyo\", \"Amara\", \"Obinna\", \"Lamine\", \"Omari\",\n    \"Zola\", \"Omari\", \"Akua\", \"Ade\", \"Zuberi\", \"Malik\", \"Zola\", \"Nkechi\", \"Juma\", \"Obinna\",\n    \"Fatou\", \"Ngozi\", \"Gbenga\", \"Ade\", \"Penda\", \"Nia\", \"Omari\", \"Obinna\", \"Zainab\", \"Amina\"\n];", "import {\n    Insight,\n    InsightRow,\n    Operation,\n    Operations,\n    Mutation\n} from './types';\nimport { actions, visitors } from \"./mock\";\n\nfunction getRandomNumber(min: number, max: number): number {\n    return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\nfunction gaussianRandom(mean: number, stdev: number) {\n    const u = 1 - Math.random();\n    const v = Math.random();\n    const z = Math.sqrt( -2.0 * Math.log( u ) ) * Math.cos( 2.0 * Math.PI * v );\n    return z * stdev + mean;\n}\n\nfunction generateInsightRow(): InsightRow {\n    return {\n        id: Math.floor(Math.random() * 100000000),\n        name: visitors[Math.floor(Math.random() * visitors.length)],\n        action: actions[Math.floor(Math.random() * actions.length)],\n    };\n}\n\nfunction generateInsight(): Insight {\n    const numRows = Math.max(1, gaussianRandom(25, 10));\n    return {\n        title: `Pitchdeck ${Math.floor(Math.random() * 1000)}`,\n        rows: Array.from({ length: numRows }, generateInsightRow),\n    };\n}\n\nexport class InsightEngine {\n    private _insights: Array<Insight>;\n\n    constructor() {\n        this._insights = this.resetInsights();\n    }\n\n    private resetInsights() {\n        return Array.from({ length: 3 }, generateInsight);\n    }\n\n    insights(): ReadonlyArray<Insight> {\n        return this._insights;\n    }\n\n    /**\n     * TODO Add implementation below\n     * @returns \n     */\n    mutate(): Mutation {\n        const operation = this.getRandomOperation();\n\n        switch (operation) {\n            case Operation.AddRows: {\n\n            }\n\n            case Operation.DelRows: {\n\n            }\n\n            case Operation.SortRows: {\n\n            }\n\n            case Operation.AddInsights: {\n\n            }\n\n            case Operation.DelInsights: {\n\n            }\n\n            case Operation.SortInsights: {\n\n            }\n        }\n\n        return { type: Operation.NoOp };\n    }\n\n    private getRandomOperation(): Operation {\n        return Operations[getRandomNumber(Operation.AddRows, Operation.SortInsights)];\n    }\n}"],
  "mappings": ";AAAA,SAAS,oBAAqD;AAC9D,SAAS,uBAAuB;AAChC,SAAS,gBAAgB;AACzB,SAAS,YAAY;;;ACmBd,IAAM,aAA0B;AAAA,EACnC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ;;;AC/BO,IAAM,UAAU;AAAA,EACnB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ;A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",
  "names": []
}
